var Router=Backbone.Router.extend({routes:{"":"homePage",instructorPage:"instructorPage","instructorPage/createNewProject":"createNewProjectPage","instructorPage/:collaboration":"collaborationPage"},initialize:function(){},homePage:function(){new HomePageView},instructorPage:function(){new InstructorView;var a=new ProjectCollection;a.fetch({success:function(a){a.each(function(a){new ProjectPaneView({model:a})})}})},createNewProjectPage:function(){new CreateProjectView},collaborationPage:function(){new CollaborationView}}),ProjectPaneView=Parse.View.extend({projectsPaneTemplate:_.template($("#renderedProject").text()),events:{"click .project-remove":"removeProject","click .project-edit":"editProject","click .project-collaborate":"goToCollaboratePage"},initialize:function(){$(".project-pane").prepend(this.el),this.render()},render:function(){var a=this.projectsPaneTemplate({model:this.model});this.$el.html(a)},removeProject:function(){console.log("removeProject Firing!"),this.$el.html(""),this.model.destroy({success:function(){console.log("delete successful")},error:function(){console.log("The delete failed")}})},editProject:function(){console.log("editProject firing!")},goToCollaboratePage:function(){new CollaborationView,window.router.navigate("instructorPage/:collaboration",{trigger:!0})}}),RenderMessagesView=Parse.View.extend({className:"rendered-message",messagesTemplate:_.template($("#message-pane").text()),initialize:function(){$(".message-pane").prepend(this.el),this.render()},render:function(){var a=this.messagesTemplate({model:this.model});this.$el.html(a)}}),HomePageView=Parse.View.extend({homePageTemplate:_.template($("#home-page-template").text()),events:{"click .js-save-instructor-registration":"registerInstructor","click .js-instructor-login":"loginInstructor"},initialize:function(){$("body").empty(),$("body").append(this.el),this.render()},render:function(){this.$el.html(this.homePageTemplate())},loginInstructor:function(){var a=$(".js-instructor-login-username").val(),b=$(".js-instructor-login-password").val();Parse.User.logIn(a,b,{success:function(){window.router.navigate("instructorPage",{trigger:!0})},error:function(a,b){console.log(b),$(".login-error-message").append("ERROR: Invalid username/password combination. Please try again.")}})},registerInstructor:function(){var a=new Parse.User;a.set("username",$(".js-instructor-username").val()),a.set("password",$(".js-instructor-password").val()),a.set("email",$(".js-instructor-email").val()),a.signUp(null,{success:function(){router.navigate("instructorPage",{trigger:!0})},error:function(a,b){console.log(b),$(".js-instructor-username").val(""),$(".create-username").addClass("has-error"),$(".error-message").append("Sorry, "+b.message+". Please try again.")}})}}),InstructorView=Parse.View.extend({projectsTemplate:_.template($("#projects").text()),initialize:function(){$("body").html(this.el),this.render()},render:function(){var a=this.projectsTemplate({model:this.model});this.$el.html(a)}}),StudentView=Parse.View.extend({}),CreateProjectView=Parse.View.extend({createNewProjectTemplate:_.template($("#create-new-project-template").text()),events:{"click .js-save-new-project":"saveProject"},initialize:function(){console.log("CreateProjectView INITIALIZED!"),$("body").empty(),$("body").prepend(this.el),this.render()},render:function(){console.log("CreateProjectView RENDERED!"),this.$el.html(this.createNewProjectTemplate())},saveProject:function(){var a=new Project;a.set("projectName",$(".js-project-name").val()),a.set("projectDescription",$(".js-project-description").val()),a.set("projectDueDate",$(".js-project-due-date").val()),a.set("projectInstructions",$(".js-project-instructions").val()),a.set("instructor",Parse.User.current()),a.setACL(new Parse.ACL(Parse.User.current())),a.save(null,{success:function(a){alert("New object created with objectId: "+a.id),window.router.navigate("instructorPage",{trigger:!0})},error:function(a,b){alert("Failed to create new object, with error code: "+b.description)}})}}),CollaborationView=Parse.View.extend({collaborationViewTemplate:_.template($("#collaboration-view-template").text()),events:{"keypress .js-message":"sendMessage"},initialize:function(){console.log(Parse.User.current().attributes.username),$("body").empty(),$("body").prepend(this.el),this.render();var a=new MessageCollection;a.fetch({success:function(a){a.each(function(a){new RenderMessagesView({model:a})})}})},render:function(){var a=this.collaborationViewTemplate({model:this.model});this.$el.html(a)},sendMessage:function(a){if(13===a.which){var b=new Message;b.set("newMessage",$(".js-message").val()),b.set("date",Date.now()),b.set("instructor",Parse.User.current()),b.set("sender",Parse.User.current().attributes.username),b.save(null,{success:function(a){var b=new MessageCollection;$(".js-message").val(""),b.fetch({success:function(){new RenderMessagesView({model:a})}})},error:function(a,b){alert("Failed to create new object, with error code: "+b.description)}})}}}),Project=Parse.Object.extend("Project"),ProjectCollection=Parse.Collection.extend({model:Project}),Message=Parse.Object.extend("Message"),MessageCollection=Parse.Collection.extend({model:Message});$(function(){Parse.initialize("wRZ1tP8WGEzVkIIcDZHWOQyb6hXAHcIe1bYtyxb0","LsSHeEh1sK899IlTAtzCOlM86oCppYeuCUYIt5oR"),window.router=new Router,Backbone.history.start()});